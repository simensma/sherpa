{% extends 'common/admin/layout.html' %}
{% block title %}Brukere &mdash; {{ block.super }}{% endblock %}
{% block header %}<a href="{% url admin.users.views.index %}">Brukere</a>{% endblock %}

{% block extra_js %}
  <script src="{{ STATIC_URL }}js/admin/user_management.js"></script>
{% endblock %}

{% load associationrole %}

{% block body %}

<div class="row">
  <div class="span12">
    <h2>{{ other_user.get_full_name }}</h2>
  </div>
</div>

<div class="row">
  <div class="span6">
    <h3>Brukerinfo</h3>
    <table class="table">
      <tr>
        <th>Navn</th>
        <td>{{ other_user.get_full_name }}</td>
      </tr>
      <tr>
        <th>E-post</th>
        <td><a href="mailto:{{ other_user.email }}">{{ other_user.email }}</a></td>
      </tr>
      <tr>
        <th>Telefon</th>
        <td>{{ other_user.get_profile.phone }}</td>
      </tr>
    </table>

    <h3>Medlemsinformasjon</h3>
    <p><em>Ikke tilgjengelig</em></p>
  </div>

  <div class="span6">
    <h3>Tilganger</h3>
    {% if other_user_perms.user.sherpa_admin %}
      <p>Sherpa-administrator — har tilgang til alle foreninger.</p>
    {% elif other_user_perms.user.sherpa %}
      <table class="table user-permissions">
        {% if other_user_associations.central|length > 0 %}
          <tr>
            <td colspan="2" class="group">Sentralt</td>
          </tr>
          {% for association in other_user_associations.central %}
            <tr>
              <td>{{ association.name }}</td>
              <td>{% associationrole other_user.get_profile association %}</td>
            </tr>
          {% endfor %}
        {% endif %}

        {% if other_user_associations.associations|length > 0 %}
          <tr>
            <td colspan="2" class="group">Foreninger</td>
          </tr>
          {% for association in other_user_associations.associations %}
            <tr>
              <td>{{ association.name }}</td>
              <td>{% associationrole other_user.get_profile association %}</td>
            </tr>
          {% endfor %}
        {% endif %}

        {% if other_user_associations.small_associations|length > 0 %}
          <tr>
            <td colspan="2" class="group">Turlag</td>
          </tr>
          {% for association in other_user_associations.small_associations %}
            <tr>
              <td>{{ association.name }}</td>
              <td>{% associationrole other_user.get_profile association %}</td>
            </tr>
          {% endfor %}
        {% endif %}

        {% if other_user_associations.hike_groups|length > 0 %}
          <tr>
            <td colspan="2" class="group">Turgrupper</td>
          </tr>
          {% for association in other_user_associations.hike_groups %}
            <tr>
              <td>{{ association.name }}</td>
              <td>{% associationrole other_user.get_profile association %}</td>
            </tr>
          {% endfor %}
        {% endif %}
      </table>

    {% else %}
      <p>Har ikke tilgang til Sherpa.</p>
    {% endif %}

    {% if not other_user_perms.user.sherpa_admin %}
      <h3>Gi tilganger</h3>

      {% if perms.user.sherpa_admin %}
        <p><a href="javascript:undefined" class="btn btn-danger make-sherpa-admin">Gjør til Sherpa-admin</a></p>
        <div class="alert alert-error hide make-sherpa-admin">
          <p>
            <strong>Gjør brukeren til Sherpa-administrator?</strong><br>
            Sherpa-administratorer har tilgang til absolutt alt, og kan gjøre andre brukere til Sherpa-administratorer.
          </p>
          <p><a href="{% url admin.users.views.make_sherpa_admin other_user.id %}" class="btn btn-success"><i class="icon-ok"></i> Ja, gjør {{ other_user.get_full_name }} til Sherpa-administrator</a></p>
          <p><a href="javascript:undefined" class="btn cancel"><i class="icon-remove"></i> Nei, avbryt</a></p>
        </div>
      {% endif %}
    {% endif %}

  </div>
</div>

{% endblock %}
