<div class="date-root{% if not date %} hide{% endif %}" data-date-id="{{ date.id }}">

  <div class="date-view{% if not date %} hide{% endif %}">

    <div class="control-group">
      <label class="control-label">Turdato:</label>
      <div class="controls">
        <div class="control-as-text">

          <div class="date-display" data-date-preview-url="{% url 'admin.aktiviteter.views.edit_date_preview' %}">
            {% include 'common/admin/aktiviteter/edit/dates_view.html' %}
          </div>

          <img class="ajaxloader hide" src="{{ STATIC_URL }}img/ajax-loader-small.gif" alt="Laster, vennligst vent...">
          <div class="fail hide">
            <a href="javascript:undefined" class="edit-date">
              Beklager, det oppstod en feil når vi prøvde å tolke datoene du valgte. <i class="icon-chevron-down"></i>
            </a>
          </div>

        </div>
      </div>
    </div>

  </div>

  <div class="date-edit{% if date %} hide{% endif %}">

    <div class="control-group">
      <div class="controls">
        <div class="control-as-text">
          <a href="javascript:undefined" class="delete-date"><i class="icon-remove"></i> Slett denne turdatoen</a>
        </div>
      </div>
    </div>

    <div class="control-group">
      <label class="control-label">Start / slutt:</label>
      <div class="controls">

        <div class="input-append date">
          <input type="text" class="input-medium" name="start_date" value="{{ date.start_date|date:"d.m.Y" }}">
          <span class="add-on"><i class="icon-th"></i></span>
        </div>
        <input type="text" class="input-small" name="start_time" value="{{ date.start_date|date:"H:i" }}">

        til

        <div class="input-append date">
          <input type="text" class="input-medium" name="end_date" value="{{ date.end_date|date:"d.m.Y" }}">
          <span class="add-on"><i class="icon-th"></i></span>
        </div>
        <input type="text" class="input-small" name="end_time" value="{{ date.end_date|date:"H:i" }}">

      </div>
    </div>

    <div class="control-group">
      <label class="control-label">Påmelding:</label>
      <div class="controls">
        <label class="radio" data-popover data-trigger="hover" data-placement="left" data-title="Min side-bruker" data-content="Denne påmeldingstypen krever at brukeren logger seg på Min side. Dette krever ikke nødvendigvis medlemskap i DNT, men man må enten registrere seg, eller logge på.">
          <input type="radio" name="enrollment{% if date %}-date-{{ date.id }}{% endif %}" value="minside"{% if date.signup_enabled and not date.signup_simple_allowed %} checked{% endif %}> Med Min side-bruker
        </label>
        <label class="radio" data-popover data-trigger="hover" data-placement="left" data-html="true" data-title="Enkel påmelding" data-content="I tillegg til vanlig påmelding med Min side-bruker, får man også muligheten til å bare skrive inn et navn, samt telefonnummer <strong>eller</strong> e-postadresse. Dette er for de som ikke ønsker å ta seg bryet med å registrere seg, men husk at disse ikke får turhistorikken registrert på Min side.">
          <input type="radio" name="enrollment{% if date %}-date-{{ date.id }}{% endif %}" value="simple"{% if date.signup_enabled and date.signup_simple_allowed %} checked{% endif %}> Oppgi navn og e-post eller telefonnummer
        </label>
        <label class="radio" data-popover data-trigger="hover" data-placement="left" data-title="Ingen påmelding" data-content="Hvis det ikke er behov for påmelding online, kan du velge denne. Da kan du eventuelt nevne i beskrivelsen hvordan deltakerne skal melde ifra deltakelse, hvis det er behov for det.">
          <input type="radio" name="enrollment{% if date %}-date-{{ date.id }}{% endif %}" value="none"{% if not date or not date.signup_enabled %} checked{% endif %}> Ingen påmelding
        </label>
      </div>
    </div>

    <div class="enrollment-group{% if not date %} hide{% endif %}">

      <div class="control-group">
        <label class="control-label">Påmeldingsstart:</label>
        <div class="controls">
          <div class="input-append date">
            <input type="text" class="input-medium" name="signup_start" value="{{ date.signup_start|date:"d.m.Y" }}">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>
        </div>
      </div>

      <div class="control-group">
        <label class="control-label">Påmeldingsfrist:</label>
        <div class="controls">
          <div class="input-append date">
            <input type="text" class="input-medium" name="signup_deadline" value="{{ date.signup_deadline|date:"d.m.Y" }}">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>
          <div class="hints">
            Hvis du ikke legger inn noen påmeldingsfrist, blir den samme dag som turen starter.
          </div>
        </div>
      </div>

      <div class="control-group">
        <label class="control-label">Avmeldingsfrist:</label>
        <div class="controls">
          <div class="input-append date">
            <input type="text" class="input-medium" name="signup_cancel_deadline" value="{{ date.signup_cancel_deadline|date:"d.m.Y" }}">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>
          <div class="hints">
            Hvis du ikke legger inn noen avmeldingsfrist, blir den samme dag som turen starter.
          </div>
        </div>
      </div>

    </div>

    <div class="control-group">
      <label class="control-label">Turledere:</label>
      <div class="controls">

        <ul class="turleder-list">
          {% for turleder in date.get_turledere_ordered %}
            <li data-id="{{ turleder.id }}" data-type="user">
              <a href="javascript:undefined" class="remove-turleder"><i class="icon-remove"></i></a>
              {{ turleder.get_full_name }} ({{ turleder.memberid|default:"Ikke medlem" }})
            </li>
          {% endfor %}
          <li class="hide">
            <a href="javascript:undefined" class="remove-turleder"><i class="icon-remove"></i></a>
            <span class="content"></span>
          </li>
        </ul>

        <div class="turleder-search">
          <input type="text" class="input-xxlarge" name="turleder-search" placeholder="Søk etter navn eller medlemsnummer for å finne turledere...">
          <button class="btn turleder-search"><i class="icon-search"></i></button>

          <table class="table search-results hide" data-search-url="{% url 'admin.aktiviteter.views.turleder_search' %}">
            <tr>
              <th>Navn</th>
              <th>Medlemsnummer</th>
              <th>Velg turleder</th>
            </tr>

            <tr class="no-hits hide">
              <td colspan="3">Fant ingen med navn eller medlemsnummer <span class="result-mirror"></span>.</td>
            </tr>

            <tr class="short_query hide">
              <td colspan="3">
                Du må bruke minst {{ admin_user_search_char_length }} tegn når du søker, ellers vil du få alt for mange treff.
              </td>
            </tr>

            <tr class="technical-error hide">
              <td colspan="3">
                <div class="alert alert-error">
                  Beklager, det oppstod en teknisk feil ved oppslag i databasen. Feilen har blitt logget og vi vil se på problemet så snart som mulig.
                </div>
              </td>
            </tr>

            <tr class="max-hits-exceeded hide">
              <td colspan="3">
                Du fikk veldig mange treff, kun et utvalg vises her.<br>
                Prøv å søke på noe litt mer spesifikt, som for eksempel medlemsnummeret.
              </td>
            </tr>

            <tr class="loader hide">
              <td colspan="3">
                Vennligst vent mens vi søker.<br>
                Medlemsdatabasen er stor, så dette kan ta noen sekunder.<br>
                <img src="{{ STATIC_URL }}img/ajax-loader-large.gif" alt="Laster, vennligst vent...">
              </td>
            </tr>
          </table>
        </div>

        <div class="hints">
          Her kan du legge til turledere for denne turdatoen. Disse vil få tilgang til påmeldtlister på Min side. Du kan kun søke etter brukere som finnes i medlemsregisteret.
        </div>

      </div>
    </div>

    <div class="control-group">
      <label class="control-label">Oppmøte:</label>
      <div class="controls">
        <textarea rows="4" cols="80" name="meeting_place" class="input-xxlarge">{{ date.meeting_place }}</textarea>
      </div>
    </div>

    <div class="control-group">
      <label class="control-label">Kontaktinformasjon:</label>
      <div class="controls">
        <label class="radio">
          <input type="radio" name="contact_type{% if date %}-date-{{ date.id }}{% endif %}" value="arrangør"{% if not date or date.contact_type == 'arrangør' %} checked{% endif %}> Arrangørforeningens opplysninger
        </label>
        <label class="radio">
          <input type="radio" name="contact_type{% if date %}-date-{{ date.id }}{% endif %}" value="turleder"{% if date.contact_type == 'turleder' %} checked{% endif %}> Turlederens opplysninger
        </label>
        <label class="radio">
          <input type="radio" name="contact_type{% if date %}-date-{{ date.id }}{% endif %}" value="custom"{% if date.contact_type == 'custom' %} checked{% endif %}> Skriv inn selv
        </label>
      </div>
    </div>

    <div class="contact-custom{% if date.contact_type != 'custom' %} hide{% endif %}">
      <div class="control-group">
        <label class="control-label">Navn:</label>
        <div class="controls">
          <input type="text" class="input-xlarge" name="contact_custom_name" value="{{ date.contact_custom_name }}">
        </div>
      </div>

      <div class="control-group">
        <label class="control-label">Telefon:</label>
        <div class="controls">
          <input type="text" class="input-medium" name="contact_custom_phone" value="{{ date.contact_custom_phone }}">
        </div>
      </div>

      <div class="control-group">
        <label class="control-label">E-postadresse:</label>
        <div class="controls">
          <input type="text" class="input-xlarge" name="contact_custom_email" value="{{ date.contact_custom_email }}">
        </div>
      </div>
    </div>

    <div class="control-group">
      <div class="controls">
        <div class="control-as-text">
          <a href="javascript:undefined" class="view-date"><i class="icon-chevron-up"></i> Skjul og lagre denne turdatoen</a>
        </div>
      </div>
    </div>

  </div>
</div>
