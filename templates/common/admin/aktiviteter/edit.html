{% extends 'common/admin/layout.html' %}
{% block title %}Aktiviteter &mdash; {{ block.super }}{% endblock %}
{% block header %}<a href="{% url admin.aktiviteter.views.index %}">Aktiviteter</a>{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{{ STATIC_URL }}lib/bootstrap-datepicker/css/datepicker.css" media="screen">
  <!--[if lt IE 8]><link rel="stylesheet" href="{{ STATIC_URL }}lib/bootstrap-datepicker/css/datepicker-ie7fix.css" media="screen"><![endif]-->
{% endblock %}

{% block extra_js %}
  <script src="{{ STATIC_URL }}lib/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
  <script src="{{ STATIC_URL }}lib/bootstrap-datepicker/js/locales/bootstrap-datepicker.nb.js"></script>
  <script src="{{ STATIC_URL }}js/admin/tags.js"></script>
  <script src="{{ STATIC_URL }}js/admin/aktiviteter.js"></script>
{% endblock %}

{% block body %}

<div class="row">
  <div class="span12">

    <h2>Rediger aktivitet</h2>

    {# TODO: Client-side validations #}
    <form action="{% url admin.aktiviteter.views.edit aktivitet.id %}" method="post" class="edit-aktivitet form-default form-border form-horizontal">
      {% csrf_token %}

      <div class="control-group">
        <div class="controls">
          <h3>Beskrivelse og informasjon</h3>
        </div>
      </div>

      <div class="control-group title">
        <label class="control-label" for="title">Tittel:</label>
        <div class="controls">
          <input type="text" class="input-xxlarge" name="title" value="{{ aktivitet.title }}">
        </div>
      </div>

      <div class="control-group description">
        <label class="control-label" for="description">Beskrivelse:</label>
        <div class="controls">
          <textarea rows="6" cols="80" name="description" class="input-xxlarge">{{ aktivitet.description }}</textarea>
        </div>
      </div>

      <div class="control-group start_date">
        <label class="control-label" for="start_date">Starter:</label>
        <div class="controls">
          <div class="input-append date">
            <input type="text" class="input-medium" name="start_date" value="{{ aktivitet.start_date|date:"d.m.Y" }}">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>
          <input type="text" class="input-small" name="start_time" value="{{ aktivitet.start_date|date:"H:i" }}">
        </div>
      </div>

      <div class="control-group end_date">
        <label class="control-label" for="end_date">Slutter:</label>
        <div class="controls">
          <div class="input-append date">
            <input type="text" class="input-medium" name="end_date" value="{{ aktivitet.end_date|date:"d.m.Y" }}">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>
          <input type="text" class="input-small" name="end_time" value="{{ aktivitet.end_date|date:"H:i" }}">
        </div>
      </div>

      <div class="control-group tags">
        <label class="control-label" for="tags">Nøkkelord:</label>
        <div class="controls">
          <p><input type="text" class="input-large" name="tags"></p>
          <div class="tag-box">
            {% for tag in aktivitet.tags.all %}
              <div class="tag">
                <a href="javascript:undefined"><img src="/static/img/so/close-default.png"></a>
                {{ tag.name }}
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
      <div style="clear: both;"></div>

      <div class="control-group">
        <div class="controls">
          <h3>Påmelding</h3>
        </div>
      </div>

      <div class="control-group signup_enabled">
        <label class="control-label" for="signup_enabled">Tillat påmelding:</label>
        <div class="controls">
          <input type="hidden" name="signup_enabled" value="{{ aktivitet.get_signup_enabled_json }}">
          <div class="btn-group" data-toggle="buttons-radio">
            <button class="btn enable{% if aktivitet.signup_enabled %} active{% endif %}">Ja</button>
            <button class="btn disable{% if not aktivitet.signup_enabled %} active{% endif %}">Nei</button>
          </div>
        </div>
      </div>

      <div class="signup-details{% if not aktivitet.signup_enabled %} hide{% endif %}">
        <div class="control-group signup_start">
          <label class="control-label" for="signup_start">Påmeldingsstart:</label>
          <div class="controls">
            <div class="input-append date">
              <input type="text" class="input-medium" name="signup_start" value="{{ aktivitet.signup_start|date:"d.m.Y" }}">
              <span class="add-on"><i class="icon-th"></i></span>
            </div>
          </div>
        </div>

        <div class="control-group signup_deadline">
          <label class="control-label" for="signup_deadline">Påmeldingsfrist:</label>
          <div class="controls">
            <div class="input-append date">
              <input type="text" class="input-medium" name="signup_deadline" value="{{ aktivitet.signup_deadline|date:"d.m.Y" }}">
              <span class="add-on"><i class="icon-th"></i></span>
            </div>
          </div>
        </div>

        <div class="control-group signup_cancel_deadline">
          <label class="control-label" for="signup_cancel_deadline">Avmeldingsfrist:</label>
          <div class="controls">
            <div class="input-append date">
              <input type="text" class="input-medium" name="signup_cancel_deadline" value="{{ aktivitet.signup_cancel_deadline|date:"d.m.Y" }}">
              <span class="add-on"><i class="icon-th"></i></span>
            </div>
          </div>
        </div>
      </div>

      <div class="control-group">
        <div class="controls">
          <h3>Synlighet</h3>
        </div>
      </div>

      <div class="control-group pub_date">
        <label class="control-label" for="pub_date">Publiseres:</label>
        <div class="controls">
          <div class="input-append date">
            <input type="text" class="input-medium" name="pub_date" value="{{ aktivitet.pub_date|date:"d.m.Y" }}">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>
          <div class="hints">
            En upublisert aktivitet vises ikke på nettsidene, selv om den er privat.
          </div>
        </div>
      </div>

      <div class="control-group hide_aktivitet">
        <label class="control-label" for="hide_aktivitet">Tilgjengelighet:</label>
        <div class="controls">
          <input type="hidden" name="hidden">
          <div class="btn-group" data-toggle="buttons-radio">
            <button class="btn show_aktivitet{% if not aktivitet.hidden %} active{% endif %}">Offentlig</button>
            <button class="btn hide_aktivitet{% if aktivitet.hidden %} active{% endif %}">Privat</button>
          </div>
          <div class="hints">
            En privat aktivitet kommer ikke frem i <a href="{% url aktiviteter.views.index %}">søket</a>, men kan sees på følgende adresse:<br>
            <a href="{% url aktiviteter.views.show aktivitet.id %}">http://{{ site.domain }}{% url aktiviteter.views.show aktivitet.id %}</a>
          </div>
        </div>
      </div>

      <div class="control-group">
        <div class="controls">
          <button type="submit" class="btn btn-success"><i class="icon-ok icon-white"></i> Lagre aktivitet</button>
        </div>
      </div>

    </form>

    <h3>Påmeldte</h3>
    {% if aktivitet.participants.all|length > 0 %}
      <table class="table">
        {% for profile in aktivitet.participants.all %}
          <tr>
            <td>{{ profile.get_full_name }}</td>
          </tr>
        {% endfor %}
      </table>
    {% else %}
      <p>Turen har ingen påmeldte deltakere.</p>
    {% endif %}

  </div>
</div>

{% endblock %}
