<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../bower_components/flatiron-director/flatiron-director.html">
<link rel="import" href="../../../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../../../bower_components/core-pages/core-pages.html">
<link rel="import" href="../../../../bower_components/core-animated-pages/transitions/slide-from-right.html">

<link rel="import" href="../dnt-aktivitet-signup-nav/dnt-aktivitet-signup-nav.html">
<link rel="import" href="../dnt-aktivitet-signup-step-participants/dnt-aktivitet-signup-step-participants.html">
<link rel="import" href="../dnt-aktivitet-signup-step-summary/dnt-aktivitet-signup-step-summary.html">
<link rel="import" href="../dnt-aktivitet-signup-step-receipt/dnt-aktivitet-signup-step-receipt.html">

<polymer-element name="dnt-aktivitet-signup" attributes="aktivitet_id aktivitet_date_id user_id">

  <template>
    <link rel="stylesheet" href="dnt-aktivitet-signup.css">

    <core-ajax
      id="aktivitet_ajax"
      auto
      handleAs="json"
      response="{{aktivitet}}"
      on-core-response="{{handleAktivitetResponse}}">
    </core-ajax>

    <core-ajax
      id="user_ajax"
      auto
      handleAs="json"
      response="{{user}}"
      on-core-response="{{handleUserResponse}}">
    </core-ajax>

    <dnt-aktivitet-signup-nav aktivitet="{{aktivitet}}" steps="{{steps}}" state="{{state}}"></dnt-aktivitet-signup-nav>

    <div vertical layout>
      <template if="{{ user.is_new }}">
        <p>Du er nå registrert hos oss og kan logge inn med epost-adressen og passordet du valgte neste gang du skal melde deg på en tur.</p>
      </template>

      <flatiron-director route="{{state.step.slug}}" autoHash></flatiron-director>

      <core-pages valueattr="hash" selected="{{state.step.slug}}">

        <section hash="beskrivelse">
          <div class="description">
            <content></content>
          </div>
        </section>

        <section hash="deltakere">
          <dnt-aktivitet-signup-step-participants
            state="{{state}}"
            actions="{{actions}}"
            participant="{{participant}}"
            user="{{user}}"
            step="{{steps.participants}}"
            steps="{{steps}}">
          </dnt-aktivitet-signup-step-participants>
        </section>

        <section hash="oppsummering">
          <dnt-aktivitet-signup-step-summary
            state="{{state}}"
            aktivitet="{{aktivitet}}"
            participant="{{participant}}"
            step="{{steps.summary}}"
            steps="{{steps}}"
            aktivitet_date_id="{{aktivitet_date_id}}">
          </dnt-aktivitet-signup-step-summary>
        </section>

        <section hash="kvittering">
          <dnt-aktivitet-signup-step-receipt
            state="{{state}}"
            aktivitet="{{aktivitet}}"
            participant="{{participant}}"
            step="{{steps.receipt}}">
          </dnt-aktivitet-signup-step-receipt>
        </section>

      </core-pages>
    </div>

  </template>

  <script src="dnt-aktivitet-signup.js"></script>
  <script src="../../../../bower_components/momentjs/moment.js"></script>
</polymer-element>
